---
title: üèÅ–•–∞–∫–∞—Ç–æ–Ω BEST Hack‚Äô22
tags:
  - java
  - postgresql
  - hackaton
  - server
---
# [üèÅGitHub BEST Hack‚Äô22](https://github.com/Kanzu32/FinalBestHack-2022-Kanzu)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
* Java;
* PostgreSQL.

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∑–∞–ø—Ä–∞–≤–∫–∞—Ö - –ø–æ–ª—É—á–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –∑–∞–¥–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –ï—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –Ω–∞—á–∏–Ω–∞—è –æ—Ç `.csv` —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–∞ Spring Boot —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º ORM, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∏ –±—É–¥–µ—Ç –∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –≤ –æ–¥–∏–Ω —Ñ–æ—Ä–º–∞—Ç, –∞ –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ë–î, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ —Å–µ—Ä–≤–∏—Å–∞ (–Ω—É–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ —ç—Ç–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏). –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–Ω–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ, —Ç–æ –µ—Å—Ç—å –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π. –¢–∞–∫ –∫–∞–∫ –±—É–¥–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–∞–º—ã—Ö —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è (–æ–¥–Ω–∞–∫–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ–±—ã –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ). –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è.

## –†–µ—à–µ–Ω–∏–µ
–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∞ —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞c—à–∏—Ä–µ–Ω–∏–µ–º `xml`, `csv`, `json`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ SOAP –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ REST. –í —Ñ–∞–π–ª–µ `application.properties` –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `in_format`, –∞ —Ç–∞–∫ –∂–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î. –ü—Ä–∏–º–µ—Ä—ã:

```java
 in_format=xml
```

```java
 in_format=csv
```
 
```java
 in_format=xml
```

–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ 8 –ø–æ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –°–£–ë–î PostgreSQL. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–≤ sql –∑–∞–ø—Ä–æ—Å:

```java
 CREATE TABLE IF NOT EXISTS public.table1
(
    name character varying COLLATE pg_catalog."default" NOT NULL,
    address character varying COLLATE pg_catalog."default" NOT NULL,
    latitude character varying COLLATE pg_catalog."default" NOT NULL,
    longtitude character varying COLLATE pg_catalog."default" NOT NULL,
    country character varying COLLATE pg_catalog."default" NOT NULL,
    phone character varying COLLATE pg_catalog."default" NOT NULL,
    region character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT "Table1_pkey" PRIMARY KEY (name)
)
```

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞ –≤ —Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É Postman. (–∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª —á–µ—Ä–µ–∑ Postman –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å [–∑–¥–µ—Å—å](https://www.youtube.com/watch?v=sFlPa_Vow3w). –ü–æ—Å–ª–µ —É–∫–∞–∑–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å post-–∑–∞–ø—Ä–æ—Å —Å —Ñ–∞–π–ª–æ–º. –°–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤ application.properties. –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç, —Ç–æ –≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ "–î–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.". –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å –≤–µ—Ä–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "File added to the database.". –î–∞–ª—å—à–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–∑–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–π –ª–æ–≥–∏–∫–∏:

```java
public String handleFileUpload(@RequestParam("file") MultipartFile file) throws IOException, ParserConfigurationException, SAXException, XMLStreamException {
		String rawType = file.getContentType();
		String type = rawType.substring(rawType.lastIndexOf("/")+1);
		if (!type.equals(format)) {
			throw new IOException("–§–æ—Ä–º–∞—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ñ–æ—Ä–º–∞—Ç–æ–º, —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.");
		} else if (format.equals("json")) {
			convertService.parseFromJSON(file);
		} else if (format.equals("csv")){
			convertService.parseFromCSV(file);
		} else if (format.equals("xml") || format.equals("soap")){
			convertService.parseFromXML(file);
		} else {
			throw new IOException("–î–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.");
		}
		return file.getContentType();

	}
```

–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `class ConvertServiceImpl`, –æ–Ω –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `ConvertService`, –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –µ—ë –≤ –∫–ª–∞—Å—Å–µ `ConvertServiceImpl`.

```java
public interface ConvertService {
	void parseFromJSON(MultipartFile file) throws IOException;
	void parseFromXML(MultipartFile file) throws SAXException, IOException, ParserConfigurationException, XMLStreamException;
	void parseFromCSV(MultipartFile file) throws IOException;
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ json —Ñ–∞–π–ª–æ–≤
–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Gson. –ò–∑ json'a –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é, –¥–∞–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–æ–ª—é name –≤ –ë–î –∏ –µ–ª–∏ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∑–∞–ø–∏—Å—å. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ json —Ñ–∞–π–ª–æ–≤:

```java
public void parseFromJSON(MultipartFile file) throws IOException {
		Gson gson = new Gson();
		Type userListType = new TypeToken<ArrayList<Station>>(){}.getType();
		String str = new String(file.getBytes());
		List<Station> stationListJSON = gson.fromJson(str, userListType);
		for (Station station : stationListJSON) {
			if (!stationRepository.existsById(station.getName())) {
				stationRepository.save(station);
			}
		}
	}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ csv —Ñ–∞–π–ª–æ–≤
–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ OpenCSV. –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –ø–æ—Å—Ç—Ä–æ—á–Ω–æ, —Ä–∞–∑–±–∏–≤–∞—è –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ Station, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ –ø–æ–ª—é name –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–∞—è –∑–∞–ø–∏—Å—å –≤ –ë–î, –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ë–î. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```java
public void parseFromCSV(MultipartFile file) throws IOException {

		CSVReader reader = new CSVReader(new FileReader(convertMultiPartToFile(file)), '|', '"', 1);
		String[] nextLine;
		while ((nextLine = reader.readNext()) != null) {
			if (!stationRepository.existsById(nextLine[3])) {
				Station station = new Station();
				station.setAddress(nextLine[0]);
				station.setLatitude(nextLine[1]);
				station.setLongtitude(nextLine[2]);
				station.setName(nextLine[3]);
				station.setCountry(nextLine[4]);
				station.setPhone(nextLine[5]);
				station.setRegion(nextLine[6]);
				stationRepository.save(station);
			}
		}

	}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ xml —Ñ–∞–π–ª–æ–≤
–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ StAX. –°—á–∏—Ç—ã–≤–∞–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ç–µ–≥–∏ –∏ –∏—â–µ–º –Ω—É–∂–Ω—ã–µ –¥–ª—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å—É—â–Ω–æ—Å—Ç—å, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–ª—é name –ë–î, –µ—Å–ª–∏ –Ω–µ—Ç , —Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ë–î. –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```java
public void parseFromXML(MultipartFile file) throws IOException, XMLStreamException {
		XMLInputFactory xmlInputFactory = XMLInputFactory.newInstance();
		XMLEventReader reader = xmlInputFactory.createXMLEventReader(new FileInputStream(convertMultiPartToFile(file)));
		Station station = new Station();
		while (reader.hasNext()) {
			XMLEvent nextEvent = reader.nextEvent();
			if (nextEvent.isStartElement()) {
				StartElement startElement = nextEvent.asStartElement();
				switch (startElement.getName().getLocalPart()) {
					case "address":
						station = new Station();
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setAddress("-");
						} else {
							station.setAddress(nextEvent.asCharacters().getData());
						}
						break;
					case "latitude":
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setLatitude("-");
						} else {
							station.setLatitude(nextEvent.asCharacters().getData());
						}

						break;
					case "longtitude":
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setLongtitude("-");
						} else {
							station.setLongtitude(nextEvent.asCharacters().getData());
						}
						break;
					case "name":
						nextEvent = reader.nextEvent();
						station.setName(nextEvent.asCharacters().getData());
						break;
					case "country":
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setCountry("-");
						} else {
							station.setCountry(nextEvent.asCharacters().getData());
						}
						break;
					case "phone":
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setPhone("-");
						} else {
							station.setPhone(nextEvent.asCharacters().getData());
						}
						break;
					case "region":
						nextEvent = reader.nextEvent();
						if (!nextEvent.isCharacters()) {
							station.setRegion("-");
						} else {
							station.setRegion(nextEvent.asCharacters().getData());
						}
						if (!stationRepository.existsById(station.getName())) {
							stationRepository.save(station);
						}
						break;
				
				}
			}
		}
	}
```

–í –∫–æ—Ä–Ω–µ –µ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã.